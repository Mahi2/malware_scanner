<?php 
require("core.php");
head();
?>
<div class="content-wrapper">

<!--CONTENT CONTAINER-->
<!--===================================================-->
<div id="content-container">
    
    <section class="content-header">
      <h1><i class="fa fa-check"></i> Security Check</h1>
      <ol class="breadcrumb">
            <li><a href="dashboard.php"><i class="fa fa-home"></i> Admin Panel</a></li>
         <li class="active">Security Check</li>
      </ol>
    </section>


    <!--Page content-->
    <!--===================================================-->
    <section class="content">

    <div class="row">
    <div class="col-md-9">

                    <div class="nav-tabs-custom">
                    <ul class="nav nav-tabs nav-justified">
                        <li class="active">
                            <a href="#f1" data-toggle="tab" class="text-center">Command Execution</a>
                        </li>
                        <li>
                            <a href="#f2" data-toggle="tab" class="text-center">PHP Code Execution</a>
                        </li>
                        <li>
                            <a href="#f3" data-toggle="tab" class="text-center">Information Disclosure</a>
                        </li>
                        <li>
                            <a href="#f4" data-toggle="tab" class="text-center">Filesystem Functions</a>
                        </li>
                        <li>
                            <a href="#f5" data-toggle="tab" class="text-center">Other</a>
                        </li>			
                    </ul>
                    <div class="tab-content">
                        <div id="f1" class="tab-pane fade active in">
                            <br /><div class="well">Executing commands and returning the complete output</div>
                                <blockquote>
                                    <p>exec &nbsp;&nbsp;
<?php
if (function_exists('exec')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>
                                    <pre>Returns last line of commands output</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>passthru &nbsp;&nbsp;
<?php
if (function_exists('passthru')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>
                                    &nbsp;&nbsp; <pre>Passes commands output directly to the browser</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>system &nbsp;&nbsp;
<?php
if (function_exists('system')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>
                                    <pre>Passes commands output directly to the browser and returns last line</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>shell_exec &nbsp;&nbsp;
<?php
if (function_exists('shell_exec')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>
                                    <pre>Returns commands output</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>popen &nbsp;&nbsp; 
<?php
if (function_exists('popen')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>
                                    <pre>Opens read or write pipe to process of a command</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>proc_open &nbsp;&nbsp; 
<?php
if (function_exists('proc_open')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>
                                    <pre>Similar to popen() but greater degree of control</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>pcntl_exec &nbsp;&nbsp; 
<?php
if (function_exists('pcntl_exec')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>
                                    <pre>Executes a program</pre></p>
                                </blockquote>
                        </div>
                        
                        <div id="f2" class="tab-pane fade">
                            <br /><div class="well">Apart from eval there are other ways to execute PHP code: include/require can be used for remote code execution in the form of Local File Include and Remote File Include vulnerabilities.</div>
                                <blockquote>
                                    <p>eval &nbsp;&nbsp; 
                                    <span class="label label-danger">Not Disabled</span>
                                    <pre>Evaluate a string as PHP code</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>assert &nbsp;&nbsp; 
<?php
if (function_exists('assert')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>
                                     <pre>Identical to eval()</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>preg_replace &nbsp;&nbsp; 
<?php
if (function_exists('preg_replace')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>
                                    <pre>Does an eval() on match</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>create_function &nbsp;&nbsp; 
<?php
if (function_exists('create_function')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Create an anonymous (lambda-style) function</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>include &nbsp;&nbsp; 
                                    <span class="label label-danger">Not Disabled</span>
                                    <pre>Includes and evaluates the specified file</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>include_once &nbsp;&nbsp; 
                                    <span class="label label-danger">Not Disabled</span>
                                    <pre>Includes and evaluates the specified file during the execution of script</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>require &nbsp;&nbsp; 
                                    <span class="label label-danger">Not Disabled</span>
                                    <pre>Identical to include</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>require_once &nbsp;&nbsp; 
                                    <span class="label label-danger">Not Disabled</span>
                                    <pre>Identical to require except PHP will check if the file has already been included, and if so, not include (require) it again.</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>allow_url_fopen &nbsp;&nbsp; 
<?php
if (function_exists('allow_url_fopen')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>
                                    <pre>This option enables the URL-aware fopen wrappers that enable accessing URL object like files - File inclusion vulnerability</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>allow_url_include &nbsp;&nbsp; 
<?php
if (function_exists('allow_url_include')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>This option allows the use of URL-aware fopen wrappers with the following functions: include, include_once, require, require_once - File inclusion vulnerability</pre></p>
                                </blockquote>
                        </div>
                        
                        <div id="f3" class="tab-pane fade">
                            <br /><div class="well">Most of these function calls are not sinks. But rather it maybe a vulnerability if any of the data returned is viewable to an attacker. If an attacker can see phpinfo() it is definitely a vulnerability.</div>
                                <blockquote>
                                    <p>phpinfo &nbsp;&nbsp; 
<?php
if (function_exists('phpinfo')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                              
                                    <pre>Outputs information about PHP's configuration</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>expose_php &nbsp;&nbsp; 
<?php
if (function_exists('expose_php')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                  
                                    <pre>Adds your PHP version to the response headers and this could be used for security exploits</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>display_errors &nbsp;&nbsp; 
<?php
if (function_exists('display_errors')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Shows PHP errors to the client and this could be used for security exploits</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>display_startup_errors &nbsp;&nbsp; 
<?php
if (function_exists('display_startup_errors')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Shows PHP startup sequence errors to the client and this could be used for security exploits</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>posix_getlogin &nbsp;&nbsp; 
<?php
if (function_exists('posix_getlogin')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Return login name</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>posix_ttyname &nbsp;&nbsp; 
<?php
if (function_exists('posix_ttyname')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Determine terminal device name</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>getenv &nbsp;&nbsp; 
<?php
if (function_exists('getenv')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Gets the value of an environment variable</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>get_current_user &nbsp;&nbsp; 
<?php
if (function_exists('get_current_user')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Gets the name of the owner of the current PHP script</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>proc_get_status &nbsp;&nbsp; 
<?php
if (function_exists('proc_get_status')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Get information about a process opened by proc_open()</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>get_cfg_var &nbsp;&nbsp; 
<?php
if (function_exists('get_cfg_var')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Gets the value of a PHP configuration option</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>disk_free_space &nbsp;&nbsp; 
<?php
if (function_exists('disk_free_space')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Returns available space on filesystem or disk partition</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>disk_total_space &nbsp;&nbsp; 
<?php
if (function_exists('disk_total_space')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Returns the total size of a filesystem or disk partition</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>diskfreespace &nbsp;&nbsp; 
<?php
if (function_exists('diskfreespace')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Alias of disk_free_space()</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>getcwd &nbsp;&nbsp; 
<?php
if (function_exists('getcwd')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Gets the current working directory</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>getmygid &nbsp;&nbsp; 
<?php
if (function_exists('getmygid')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Get PHP script owner's GID</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>getmyinode &nbsp;&nbsp; 
<?php
if (function_exists('getmyinode')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Gets the inode of the current script</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>getmypid &nbsp;&nbsp; 
<?php
if (function_exists('getmypid')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Gets PHP's process ID</pre></p>
                                </blockquote>
                                <blockquote>
                                    <p>getmyuid &nbsp;&nbsp; 
<?php
if (function_exists('getmyuid')) {
echo '<span class="label label-danger">Not Disabled</span>';
} else {
echo '<span class="label label-success">Disabled</span>';
}
?>                                                
                                    <pre>Gets PHP script owner's UID</pre></p>
                                </blockquote>
                        </div>
                        
                        <div id="f4" class="tab-pane fade">
                            <br /><div class="well">According to RATS all filesystem functions in PHP are nasty. Some of these don't seem very useful to the attacker. Others are more useful than you might think. For instance if allow_url_fopen=On then a url can be used as a file path, so a call to copy($_GET['s'], $_GET['d']); can be used to upload a PHP script anywhere on the system. Also if a website is vulnerable to a request send via GET everyone of those file system functions can be abused to channel and attack to another host through your server.</div>
                                <blockquote>
                                    <p>fopen &nbsp;&nbsp; 
